<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <meta property="og:site_name" content="Duck's Nest List">
    <meta property="og:type" content="list">
    <meta property="og:locale" content="en_US">
    <meta property="og:title" content="{{ location }} nests as of {{ rotation.date_priority_display }}">
	{% block self-url %}
    	<meta property="og:url" content="{% url 'nestlist:city_historic_date' location.id rotation.pk %}">
	{% endblock %}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'nestlist/css/style.css' %}">
    <!-- TODO: update icon later -->
    <link rel="icon" type="image/png" href="{% static 'nestlist/images/ballhead cc.png' %}">

    <style>
	{% if not history %}
	td.rotation,th.rotation {
		display: none;
	}{% endif %}
	{% if neighbor_view %}
	td.neighborhood,th.neighborhood {
		display: none;
	}{% endif %}
	{% if species_count == 1 %}
	td.species,th.species,td.number,th.number {
		display: none;
	}{% endif %}
    </style>

    <script type="text/javascript" src="{% static 'nestlist/js/sort_t.js' %}"></script>
    <title>
		{% if location.short_name %}
			{{ location.short_name }}
		{% elif location.name %}
			{{ location.name }}
		{% else %}
			{{ location.get_name }}  <!-- TODO: give get_name to all location-type items -->
		{% endif %}
		Nests!
	</title>
</head>
<body ontouchstart="" onclick="">
<center>
	<header>
		{% block top-nav %}
			<p><a href="{{ location.ct.report_form_url }}">Report a nest!</a></p>
		{% endblock %}
	</header>
<table id="nestList">
	<caption>{% block information %} {{ location }}<br>#{{ rotation }} {% endblock %}</caption>
	<tr>
		<th onclick="sortTable('nestList', 0)" tabindex="0" class="heading rotation">Rotation</th>
		<th onclick="sortTable('nestList', 1)" tabindex="1" class="heading neighborhood">Neighborhood</th>
		<th onclick="sortTable('nestList', 2)" tabindex="2" class="heading nest-name">Park</th>
		<th onclick="sortTable('nestList', 3)" tabindex="3" class="heading number">#</th>
		<th onclick="sortTable('nestList', 4)" tabindex="4" class="heading species">Species</th>
		<th onclick="sortTable('nestList', 5)" tabindex="5" class="heading verification">Verified?</th>
	</tr>
	{% for nest in current_nest_list %}
		<tr id="{{ nest.id }}" itemscope itemtype="https://schema.org/Place"
		class="nest {% if nest.confirmation %}confirmed{% else %}unconfirmed{% endif %}" >
			<td class="rotation">
				<span class="sort-info">{{ nest.rotation_num }}</span>
				<a href="{% url 'nestlist:city_historic_date' location.ct.pk nest.rotation_num.pk %}">{{ nest.rotation_num }}</a>
			</td>
			<td class="neighborhood" itemprop="containedInPlace"
			id="{{ nest.nestid.neighborhood.pk }}">
				<span class="sort-info">{{ nest.nestid.neighborhood }}</span>
				<a href="{{ nest.nestid.neighborhood.web_url }}">{{ nest.nestid.neighborhood }}</a>
			</td>
			<td class="nest-name tooltip" itemprop="name">
				<span class="sort-info">{{ nest.nestid.full_name }}</span>
				<a href="{{ nest.nestid.web_url }}">{{ nest.nestid.get_name }}</a>
				<address class="tooltiptext" itemprop="address">
					{% if nest.nestid.address %}
					{{ nest.nestid.address }}
					{% else %}
					<span class="address-error">No address on file</span>
					{% endif %}
					{% if nest.nestid.private %}
					<div class="privacy-notice">Private property, please be respectful</div>
					{% endif %}
				</address>
			</td>
			<td class="number">
				<span class="sort-info">{{ nest.species_no }}</span>
				<a href="{% url 'nestlist:species_history' location.ct.pk nest.species_no %}">{{ nest.species_no }}</a>
			</td>
			<td class="species">
				{% if nest.species_name_fk %}
				<span class="sort-info">{{ nest.species_name_fk }}</span>
				<a href="{% url 'nestlist:species_history' location.ct.pk nest.species_name_fk.pk %}">{{ nest.species_txt }}</a>
				{% else %}{{ nest.species_txt }}{% endif %}
			</td>
			<td class="verification">{% if nest.confirmation %}Yes{% else %}No{% endif %}</td>
		</tr>
	{% endfor %}
</table>
	<hr>
	<footer>
		{% block bottom-notes %}
		<p class="confirmed">
			Species with a <span class="species">bold name</span> and an <span class="number">italic pok√©dex number</span> have multiple confirming reports.
		</p>
		<p>Mid-rotation events may throw off the accuracy of the list.</p>
		<a href="{{ location.ct.report_form_url }}">Report a nest!</a>
		{% endblock %}
	</footer>
</center>
{% block empty-zone %}{% endblock %}
</body></html>